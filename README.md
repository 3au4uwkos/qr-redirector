# Сервис коротких ссылок и QR-кодов

Сервис для создания коротких ссылок и генерации QR-кодов с возможностью отслеживания переходов.

## 📌 Основные возможности

- Генерация коротких ссылок
- Создание QR-кодов для URL
- Валидация вводимых URL
- Статистика переходов по ссылкам
- Логирование IP-адресов посетителей
- AJAX-интерфейс без перезагрузки страницы

## 🛠 Технологии

- **Backend**: Yii2 (PHP 8.2)
- **Database**: MySQL 5.7 / MariaDB
- **Frontend**: Bootstrap 5, jQuery
- **QR-генерация**: Endroid/QrCode
- **Деплой**: Docker

## 📦 Установка

### Требования

- Docker и Docker Compose
- PHP 8.2 (если запускаете без Docker)

### Запуск через Docker

1. Клонируйте репозиторий:
   ```bash
   git clone https://github.com/3au4uwkos/qr-redirector.git
   cd qr-redirector
   ```

2. Запустите контейнеры:
   ```bash
   docker-compose up -d
   ```

3. Приложение будет доступно по адресу:
   ```
   http://localhost:8000
   ```

### Ручная установка

1. Установите зависимости:
   ```bash
   composer install
   ```

2. Настройте подключение к БД в `config/db.php`

3. Примените миграции:
   ```bash
   php yii migrate
   ```

4. Создайте папку для QR-кодов и дайте права:
   ```bash
   mkdir -p web/qr_codes/temp
   chmod -R 777 web/qr_codes
   ```

## 🗃 Структура базы данных

Проект использует 3 основные таблицы:

1. **websites** - хранит оригинальные URL и короткие коды
   - `url` - оригинальный URL
   - `short_code` - короткий код (8 символов)
   - `name_of_qr_file` - имя файла QR-кода
   - `use_number` - счетчик переходов

2. **ips** - информация о посетителях
   - `ip` - IP-адрес
   - `visit_count` - количество визитов

3. **logs** - логи переходов
   - Связывает websites и ips
   - `accessed_at` - время перехода

## 🚀 Использование

1. На главной странице введите URL в поле ввода
2. Нажмите "ОК" для проверки и генерации
3. Если URL валиден и доступен, вы получите:
   - QR-код (можно сканировать камерой)
   - Короткую ссылку (можно скопировать)
4. При переходе по короткой ссылке произойдет редирект на оригинальный URL


## 🔍 Просмотр статистики переходов

### При работе с Docker

Для просмотра статистики переходов по коротким ссылкам вы можете подключиться к MySQL в контейнере:

```bash
docker exec -it db mysql -u qr_user -p qr_db
```
При запросе пароля введите: `qr_password` или другой установленный Вами 

### При ручной установке

Вы можете просматривать статистику через интерфейс вашей локальной СУБД (phpMyAdmin, MySQL Workbench, DBeaver и др.):

1. Подключитесь к вашей MySQL/MariaDB
2. Выберите базу данных `qr_db` (или указанную вами в настройках)
3. Основные таблицы для анализа:
   - `websites` - все созданные ссылки
   - `ips` - информация о посетителях
   - `logs` - детальная история переходов

## 🌟 Особенности реализации

- Валидация URL на стороне сервера
- Проверка доступности целевого ресурса
- Генерация QR-кодов без внешних API
- Поддержка темной темы интерфейса
- Логирование всех переходов с IP-адресами
- Оптимизированные SQL-запросы и индексы

## 🔧 Настройки

Основные параметры можно изменить в файле `config/params.php`:

```php
'qrCodes' => [
    'storagePath' => '@webroot/qr_codes/temp', // Путь для хранения QR-кодов
    'webPath' => '@web/qr_codes/temp', // Web-путь к QR-кодам
    'lifetime' => 3600 // Время жизни кеша (сек)
]
```

## 📄 Лицензия

Проект использует лицензию BSD-3-Clause.

---

> Разработано Matvei Zaitsev | [3au4uwkos@gmail.com](mailto:3au4uwkos@gmail.com)
